#!/bin/bash

################################
#  Verify your system against  #
#        CVE-2024-3094         #
#                    lypd0.com #
################################

echo "  ___  _  _  ____     ___   ___  ___   __       ___   ___   ___   __  "
echo " / __)( \/ )( ___)___(__ \ / _ \(__ \ /. |  ___(__ ) / _ \ / _ \ /. | "
echo "( (__  \  /  )__)(___)/ _/( (_) )/ _/(_  _)(___)(_ \( (_) )\_  /(_  _)"
echo " \___)  \/  (____)   (____)\___/(____) (_)     (___/ \___/  (_/   (_) "

if ! command -v xz &> /dev/null; then
    echo "[-] xz package is not installed."
    exit 1
fi

xz_version=$(xz --version | head -n 1 | awk '{print $4}')

if [[ $xz_version == "5.6.0" || $xz_version == "5.6.1" ]]; then
    echo -e "\n[*] You are VULNERABLE to CVE-2024-3094\n\nIt is recommended to downgrade to a non-vulnerable version:\nhttps://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users"
else
    echo -e " \n[*] You are NOT vulnerable to CVE-2024-3094."
fi
